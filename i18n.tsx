import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';

const LANGUAGE_STORAGE_KEY = 'veo-app-language';

export type Language = 'en' | 'id' | 'es' | 'zh' | 'hi' | 'ar' | 'pt' | 'bn' | 'ru' | 'ja' | 'de' | 'fr';
type Translations = { [key: string]: string | string[] | Translations };

export const languageMap: { [key in Language]: string } = {
  en: 'English',
  id: 'Bahasa Indonesia',
  es: 'Español',
  zh: '中文 (简体)',
  hi: 'हिन्दी',
  ar: 'العربية',
  pt: 'Português',
  bn: 'বাংলা',
  ru: 'Русский',
  ja: '日本語',
  de: 'Deutsch',
  fr: 'Français',
};

const translations: { [key in Language]: Translations } = {
  // English
  en: {
    appName: "AL ANSHOR VEO GENERATOR",
    appTagline: "Generate stunning videos from text or images.",
    manageApiKeys: "Manage API Keys",
    promptLabel: "Prompt",
    promptPlaceholder: "A majestic lion overlooking the savanna at sunset...",
    promptHint: "You can use plain text or a JSON formatted string.",
    referenceImageLabel: "Reference Image (Optional)",
    uploadFile: "Upload a file",
    dragAndDrop: "or drag and drop",
    fileTypes: "PNG, JPG, GIF up to 10MB",
    generationSettings: "Generation Settings",
    aspectRatioLabel: "Aspect Ratio",
    soundLabel: "Sound",
    enableSound: "Enable sound",
    resolutionLabel: "Resolution",
    apiKeyMissingWarning: "Please add and select an active API Key to begin.",
    generateButton: "Generate Video",
    generatingButton: "Generating Video...",
    loaderTitle: "Generating Your Video",
    loadingMessages: [ "Initializing VEO model...", "Analyzing your prompt...", "Composing the main scene...", "Generating initial frames...", "Rendering video sequence... this may take a few minutes.", "Upscaling to high resolution...", "Adding sound and final touches...", "Almost there, preparing the final video file." ],
    playerTitle: "Generation Complete!",
    downloadButton: "Download Video",
    apiKeyManagerTitle: "API Key Manager",
    addNewKeyLabel: "Add New API Key",
    apiKeyInputPlaceholder: "Enter your Gemini API Key",
    addKeyButton: "Add Key",
    validatingButton: "Validating...",
    savedKeysLabel: "Saved Keys",
    noKeysSaved: "No API Keys saved.",
    addKeyPrompt: "Add a key above to get started.",
    closeButton: "Close",
    errorKeyEmpty: "API Key cannot be empty.",
    errorKeyExists: "This API Key has already been added.",
    errorKeyInvalid: "Invalid API Key or network issue. Please check the key and try again.",
    generationFailed: "Generation Failed",
    alertEnterPrompt: "Please enter a prompt.",
    alertSetApiKey: "Please set an active API key before generating a video.",
  },
  // Indonesian
  id: {
    appName: "AL ANSHOR VEO GENERATOR",
    appTagline: "Hasilkan video menakjubkan dari teks atau gambar.",
    manageApiKeys: "Kelola Kunci API",
    promptLabel: "Prompt",
    promptPlaceholder: "Seekor singa agung memandangi sabana saat matahari terbenam...",
    promptHint: "Anda bisa menggunakan teks biasa atau string format JSON.",
    referenceImageLabel: "Gambar Referensi (Opsional)",
    uploadFile: "Unggah file",
    dragAndDrop: "atau seret dan lepas",
    fileTypes: "PNG, JPG, GIF hingga 10MB",
    generationSettings: "Pengaturan Generasi",
    aspectRatioLabel: "Rasio Aspek",
    soundLabel: "Suara",
    enableSound: "Aktifkan suara",
    resolutionLabel: "Resolusi",
    apiKeyMissingWarning: "Silakan tambah dan pilih Kunci API yang aktif untuk memulai.",
    generateButton: "Hasilkan Video",
    generatingButton: "Menghasilkan Video...",
    loaderTitle: "Menghasilkan Video Anda",
    loadingMessages: [ "Menginisialisasi model VEO...", "Menganalisis prompt Anda...", "Menyusun adegan utama...", "Menghasilkan bingkai awal...", "Merender urutan video... ini mungkin memakan waktu beberapa menit.", "Meningkatkan skala ke resolusi tinggi...", "Menambahkan suara dan sentuhan akhir...", "Hampir selesai, menyiapkan file video akhir." ],
    playerTitle: "Pembuatan Selesai!",
    downloadButton: "Unduh Video",
    apiKeyManagerTitle: "Manajer Kunci API",
    addNewKeyLabel: "Tambah Kunci API Baru",
    apiKeyInputPlaceholder: "Masukkan Kunci API Gemini Anda",
    addKeyButton: "Tambah Kunci",
    validatingButton: "Memvalidasi...",
    savedKeysLabel: "Kunci Tersimpan",
    noKeysSaved: "Tidak ada Kunci API yang tersimpan.",
    addKeyPrompt: "Tambahkan kunci di atas untuk memulai.",
    closeButton: "Tutup",
    errorKeyEmpty: "Kunci API tidak boleh kosong.",
    errorKeyExists: "Kunci API ini sudah ditambahkan.",
    errorKeyInvalid: "Kunci API tidak valid atau masalah jaringan. Harap periksa kunci dan coba lagi.",
    generationFailed: "Pembuatan Gagal",
    alertEnterPrompt: "Silakan masukkan prompt.",
    alertSetApiKey: "Silakan atur kunci API aktif sebelum menghasilkan video.",
  },
  // Spanish
  es: {
    appName: "GENERADOR VEO AL ANSHOR",
    appTagline: "Genera videos impresionantes a partir de texto o imágenes.",
    manageApiKeys: "Gestionar Claves API",
    promptLabel: "Prompt",
    promptPlaceholder: "Un majestuoso león contemplando la sabana al atardecer...",
    promptHint: "Puedes usar texto plano o una cadena en formato JSON.",
    referenceImageLabel: "Imagen de Referencia (Opcional)",
    uploadFile: "Subir un archivo",
    dragAndDrop: "o arrastrar y soltar",
    fileTypes: "PNG, JPG, GIF hasta 10MB",
    generationSettings: "Ajustes de Generación",
    aspectRatioLabel: "Relación de Aspecto",
    soundLabel: "Sonido",
    enableSound: "Habilitar sonido",
    resolutionLabel: "Resolución",
    apiKeyMissingWarning: "Por favor, añade y selecciona una Clave API activa para comenzar.",
    generateButton: "Generar Video",
    generatingButton: "Generando Video...",
    loaderTitle: "Generando Tu Video",
    loadingMessages: [ "Inicializando modelo VEO...", "Analizando tu prompt...", "Componiendo la escena principal...", "Generando fotogramas iniciales...", "Renderizando secuencia de video... esto puede tardar unos minutos.", "Ampliando a alta resolución...", "Añadiendo sonido y toques finales...", "Casi listo, preparando el archivo de video final." ],
    playerTitle: "¡Generación Completa!",
    downloadButton: "Descargar Video",
    apiKeyManagerTitle: "Gestor de Claves API",
    addNewKeyLabel: "Añadir Nueva Clave API",
    apiKeyInputPlaceholder: "Introduce tu Clave API de Gemini",
    addKeyButton: "Añadir Clave",
    validatingButton: "Validando...",
    savedKeysLabel: "Claves Guardadas",
    noKeysSaved: "No hay Claves API guardadas.",
    addKeyPrompt: "Añade una clave arriba para empezar.",
    closeButton: "Cerrar",
    errorKeyEmpty: "La Clave API no puede estar vacía.",
    errorKeyExists: "Esta Clave API ya ha sido añadida.",
    errorKeyInvalid: "Clave API inválida o problema de red. Por favor, comprueba la clave e inténtalo de nuevo.",
    generationFailed: "Generación Fallida",
    alertEnterPrompt: "Por favor, introduce un prompt.",
    alertSetApiKey: "Por favor, establece una clave API activa antes de generar un video.",
  },
  // Chinese (Simplified)
  zh: {
    appName: "AL ANSHOR VEO 生成器",
    appTagline: "通过文本或图像生成令人惊叹的视频。",
    manageApiKeys: "管理 API 密钥",
    promptLabel: "提示",
    promptPlaceholder: "一只雄伟的狮子在日落时俯瞰着大草原...",
    promptHint: "您可以使用纯文本或JSON格式的字符串。",
    referenceImageLabel: "参考图像（可选）",
    uploadFile: "上传文件",
    dragAndDrop: "或拖放",
    fileTypes: "PNG, JPG, GIF, 最大10MB",
    generationSettings: "生成设置",
    aspectRatioLabel: "宽高比",
    soundLabel: "声音",
    enableSound: "启用声音",
    resolutionLabel: "分辨率",
    apiKeyMissingWarning: "请添加并选择一个有效的API密钥以开始。",
    generateButton: "生成视频",
    generatingButton: "正在生成视频...",
    loaderTitle: "正在生成您的视频",
    loadingMessages: [ "正在初始化VEO模型...", "正在分析您的提示...", "正在构图主场景...", "正在生成初始帧...", "正在渲染视频序列...这可能需要几分钟。", "正在放大到高分辨率...", "正在添加声音和最后润色...", "即将完成，正在准备最终视频文件。" ],
    playerTitle: "生成完成！",
    downloadButton: "下载视频",
    apiKeyManagerTitle: "API 密钥管理器",
    addNewKeyLabel: "添加新 API 密钥",
    apiKeyInputPlaceholder: "输入您的 Gemini API 密钥",
    addKeyButton: "添加密钥",
    validatingButton: "验证中...",
    savedKeysLabel: "已存密钥",
    noKeysSaved: "未保存任何 API 密钥。",
    addKeyPrompt: "在上方添加一个密钥以开始使用。",
    closeButton: "关闭",
    errorKeyEmpty: "API 密钥不能为空。",
    errorKeyExists: "此 API 密钥已添加。",
    errorKeyInvalid: "API 密钥无效或网络问题。请检查密钥并重试。",
    generationFailed: "生成失败",
    alertEnterPrompt: "请输入提示。",
    alertSetApiKey: "生成视频前，请设置有效的API密钥。",
  },
  // Hindi
  hi: {
    appName: "AL ANSHOR VEO जेनरेटर",
    appTagline: "टेक्स्ट या छवियों से शानदार वीडियो बनाएं।",
    manageApiKeys: "API कुंजी प्रबंधित करें",
    promptLabel: "प्रॉम्प्ट",
    promptPlaceholder: "सूर्यास्त के समय सवाना को देखता हुआ एक शानदार शेर...",
    promptHint: "आप सादा पाठ या JSON स्वरूपित स्ट्रिंग का उपयोग कर सकते हैं।",
    referenceImageLabel: "संदर्भ छवि (वैकल्पिक)",
    uploadFile: "फ़ाइल अपलोड करें",
    dragAndDrop: "या खींचें और छोड़ें",
    fileTypes: "PNG, JPG, GIF 10MB तक",
    generationSettings: "उत्पादन सेटिंग्स",
    aspectRatioLabel: "पहलू अनुपात",
    soundLabel: "ध्वनि",
    enableSound: "ध्वनि सक्षम करें",
    resolutionLabel: "रिज़ॉल्यूशन",
    apiKeyMissingWarning: "शुरू करने के लिए कृपया एक सक्रिय API कुंजी जोड़ें और चुनें।",
    generateButton: "वीडियो बनाएं",
    generatingButton: "वीडियो बना रहा है...",
    loaderTitle: "आपका वीडियो बना रहा है",
    loadingMessages: [ "VEO मॉडल प्रारंभ हो रहा है...", "आपके प्रॉम्प्ट का विश्लेषण हो रहा है...", "मुख्य दृश्य की रचना हो रही है...", "प्रारंभिक फ़्रेम उत्पन्न हो रहे हैं...", "वीडियो अनुक्रम प्रस्तुत हो रहा है... इसमें कुछ मिनट लग सकते हैं।", "उच्च रिज़ॉल्यूशन में अपस्केलिंग...", "ध्वनि और अंतिम स्पर्श जोड़ना...", "लगभग हो गया, अंतिम वीडियो फ़ाइल तैयार हो रही है।" ],
    playerTitle: "निर्माण पूर्ण!",
    downloadButton: "वीडियो डाउनलोड करें",
    apiKeyManagerTitle: "API कुंजी प्रबंधक",
    addNewKeyLabel: "नई API कुंजी जोड़ें",
    apiKeyInputPlaceholder: "अपनी जेमिनी API कुंजी दर्ज करें",
    addKeyButton: "कुंजी जोड़ें",
    validatingButton: "सत्यापन हो रहा है...",
    savedKeysLabel: "सहेजी गई कुंजियाँ",
    noKeysSaved: "कोई API कुंजी सहेजी नहीं गई।",
    addKeyPrompt: "शुरू करने के लिए ऊपर एक कुंजी जोड़ें।",
    closeButton: "बंद करें",
    errorKeyEmpty: "API कुंजी खाली नहीं हो सकती।",
    errorKeyExists: "यह API कुंजी पहले ही जोड़ी जा चुकी है।",
    errorKeyInvalid: "अमान्य API कुंजी या नेटवर्क समस्या। कृपया कुंजी जांचें और पुनः प्रयास करें।",
    generationFailed: "निर्माण विफल",
    alertEnterPrompt: "कृपया एक प्रॉम्प्ट दर्ज करें।",
    alertSetApiKey: "वीडियो बनाने से पहले कृपया एक सक्रिय एपीआई कुंजी सेट करें।",
  },
  // Arabic
  ar: {
    appName: "مولد الفيديو AL ANSHOR VEO",
    appTagline: "أنشئ مقاطع فيديو مذهلة من النصوص أو الصور.",
    manageApiKeys: "إدارة مفاتيح API",
    promptLabel: "موجه",
    promptPlaceholder: "أسد مهيب يطل على السافانا عند غروب الشمس...",
    promptHint: "يمكنك استخدام نص عادي أو سلسلة بتنسيق JSON.",
    referenceImageLabel: "صورة مرجعية (اختياري)",
    uploadFile: "تحميل ملف",
    dragAndDrop: "أو السحب والإفلات",
    fileTypes: "PNG, JPG, GIF حتى 10 ميجابايت",
    generationSettings: "إعدادات الإنشاء",
    aspectRatioLabel: "نسبة العرض إلى الارتفاع",
    soundLabel: "صوت",
    enableSound: "تفعيل الصوت",
    resolutionLabel: "دقة",
    apiKeyMissingWarning: "يرجى إضافة وتحديد مفتاح API نشط للبدء.",
    generateButton: "إنشاء فيديو",
    generatingButton: "جاري إنشاء الفيديو...",
    loaderTitle: "جاري إنشاء الفيديو الخاص بك",
    loadingMessages: [ "تهيئة نموذج VEO...", "تحليل موجهك...", "تكوين المشهد الرئيسي...", "إنشاء الإطارات الأولية...", "عرض تسلسل الفيديو... قد يستغرق هذا بضع دقائق.", "الترقية إلى دقة عالية...", "إضافة الصوت واللمسات النهائية...", "لقد أوشكنا على الانتهاء، جاري تحضير ملف الفيديو النهائي." ],
    playerTitle: "اكتمل الإنشاء!",
    downloadButton: "تنزيل الفيديو",
    apiKeyManagerTitle: "مدير مفاتيح API",
    addNewKeyLabel: "إضافة مفتاح API جديد",
    apiKeyInputPlaceholder: "أدخل مفتاح Gemini API الخاص بك",
    addKeyButton: "إضافة مفتاح",
    validatingButton: "يتم التحقق...",
    savedKeysLabel: "المفاتيح المحفوظة",
    noKeysSaved: "لا توجد مفاتيح API محفوظة.",
    addKeyPrompt: "أضف مفتاحًا أعلاه للبدء.",
    closeButton: "إغلاق",
    errorKeyEmpty: "لا يمكن أن يكون مفتاح API فارغًا.",
    errorKeyExists: "تمت إضافة مفتاح API هذا بالفعل.",
    errorKeyInvalid: "مفتاح API غير صالح أو مشكلة في الشبكة. يرجى التحقق من المفتاح والمحاولة مرة أخرى.",
    generationFailed: "فشل الإنشاء",
    alertEnterPrompt: "يرجى إدخال موجه.",
    alertSetApiKey: "يرجى تعيين مفتاح API نشط قبل إنشاء مقطع فيديو.",
  },
  // Portuguese
  pt: {
    appName: "GERADOR DE VÍDEO AL ANSHOR VEO",
    appTagline: "Gere vídeos impressionantes a partir de texto ou imagens.",
    manageApiKeys: "Gerenciar Chaves de API",
    promptLabel: "Comando",
    promptPlaceholder: "Um leão majestoso observando a savana ao pôr do sol...",
    promptHint: "Você pode usar texto simples ou uma string formatada em JSON.",
    referenceImageLabel: "Imagem de Referência (Opcional)",
    uploadFile: "Carregar um arquivo",
    dragAndDrop: "ou arraste e solte",
    fileTypes: "PNG, JPG, GIF até 10MB",
    generationSettings: "Configurações de Geração",
    aspectRatioLabel: "Proporção da Tela",
    soundLabel: "Som",
    enableSound: "Habilitar som",
    resolutionLabel: "Resolução",
    apiKeyMissingWarning: "Adicione e selecione uma Chave de API ativa para começar.",
    generateButton: "Gerar Vídeo",
    generatingButton: "Gerando Vídeo...",
    loaderTitle: "Gerando Seu Vídeo",
    loadingMessages: [ "Inicializando modelo VEO...", "Analisando seu comando...", "Compondo a cena principal...", "Gerando quadros iniciais...", "Renderizando sequência de vídeo... isso pode levar alguns minutos.", "Ampliando para alta resolução...", "Adicionando som e toques finais...", "Quase lá, preparando o arquivo de vídeo final." ],
    playerTitle: "Geração Concluída!",
    downloadButton: "Baixar Vídeo",
    apiKeyManagerTitle: "Gerenciador de Chaves de API",
    addNewKeyLabel: "Adicionar Nova Chave de API",
    apiKeyInputPlaceholder: "Digite sua Chave de API do Gemini",
    addKeyButton: "Adicionar Chave",
    validatingButton: "Validando...",
    savedKeysLabel: "Chaves Salvas",
    noKeysSaved: "Nenhuma Chave de API salva.",
    addKeyPrompt: "Adicione uma chave acima para começar.",
    closeButton: "Fechar",
    errorKeyEmpty: "A Chave de API não pode estar vazia.",
    errorKeyExists: "Esta Chave de API já foi adicionada.",
    errorKeyInvalid: "Chave de API inválida ou problema de rede. Verifique a chave e tente novamente.",
    generationFailed: "Falha na Geração",
    alertEnterPrompt: "Por favor, insira um comando.",
    alertSetApiKey: "Por favor, defina uma chave de API ativa antes de gerar um vídeo.",
  },
  // Bengali
  bn: {
    appName: "AL ANSHOR VEO জেনারেটর",
    appTagline: "টেক্সট বা ছবি থেকে потрясающие ভিডিও তৈরি করুন।",
    manageApiKeys: "API কী পরিচালনা করুন",
    promptLabel: "প্রম্পট",
    promptPlaceholder: "সূর্যাস্তের সময় সাভানার দিকে তাকিয়ে থাকা এক মহিমান্বিত সিংহ...",
    promptHint: "আপনি সাধারণ টেক্সট বা JSON ফরম্যাটেড স্ট্রিং ব্যবহার করতে পারেন।",
    referenceImageLabel: "রেফারেন্স চিত্র (ঐচ্ছিক)",
    uploadFile: "ফাইল আপলোড করুন",
    dragAndDrop: "অথবা টেনে আনুন",
    fileTypes: "PNG, JPG, GIF 10MB পর্যন্ত",
    generationSettings: "জেনারেটর সেটিংস",
    aspectRatioLabel: "আনুমানিক অনুপাত",
    soundLabel: "শব্দ",
    enableSound: "শব্দ সক্রিয় করুন",
    resolutionLabel: "রেজোলিউশন",
    apiKeyMissingWarning: "শুরু করার জন্য অনুগ্রহ করে একটি সক্রিয় API কী যোগ করুন এবং নির্বাচন করুন।",
    generateButton: "ভিডিও তৈরি করুন",
    generatingButton: "ভিডিও তৈরি হচ্ছে...",
    loaderTitle: "আপনার ভিডিও তৈরি হচ্ছে",
    loadingMessages: [ "VEO মডেল শুরু হচ্ছে...", "আপনার প্রম্পট বিশ্লেষণ করা হচ্ছে...", "মূল দৃশ্য রচনা করা হচ্ছে...", "প্রাথমিক ফ্রেম তৈরি হচ্ছে...", "ভিডিও ক্রম রেন্ডার করা হচ্ছে... এতে কয়েক মিনিট সময় লাগতে পারে।", "উচ্চ রেজোলিউশনে আপস্কেলিং...", "শব্দ এবং চূড়ান্ত ছোঁয়া যোগ করা হচ্ছে...", "প্রায় শেষ, চূড়ান্ত ভিডিও ফাইল প্রস্তুত করা হচ্ছে।" ],
    playerTitle: "তৈরি সম্পন্ন!",
    downloadButton: "ভিডিও ডাউনলোড করুন",
    apiKeyManagerTitle: "API কী ম্যানেজার",
    addNewKeyLabel: "নতুন API কী যোগ করুন",
    apiKeyInputPlaceholder: "আপনার জেমিনি API কী লিখুন",
    addKeyButton: "কী যোগ করুন",
    validatingButton: "যাচাই করা হচ্ছে...",
    savedKeysLabel: "সংরক্ষিত কী",
    noKeysSaved: "কোনো API কী সংরক্ষিত নেই।",
    addKeyPrompt: "শুরু করার জন্য উপরে একটি কী যোগ করুন।",
    closeButton: "বন্ধ করুন",
    errorKeyEmpty: "API কী খালি হতে পারে না।",
    errorKeyExists: "এই API কী ইতিমধ্যে যোগ করা হয়েছে।",
    errorKeyInvalid: "অবৈধ API কী বা নেটওয়ার্ক সমস্যা। অনুগ্রহ করে কী পরীক্ষা করে আবার চেষ্টা করুন।",
    generationFailed: "তৈরি ব্যর্থ হয়েছে",
    alertEnterPrompt: "অনুগ্রহ করে একটি প্রম্পট লিখুন।",
    alertSetApiKey: "ভিডিও তৈরি করার আগে অনুগ্রহ করে একটি সক্রিয় API কী সেট করুন।",
  },
  // Russian
  ru: {
    appName: "ГЕНЕРАТОР ВИДЕО AL ANSHOR VEO",
    appTagline: "Создавайте потрясающие видео из текста или изображений.",
    manageApiKeys: "Управление ключами API",
    promptLabel: "Запрос",
    promptPlaceholder: "Величественный лев, взирающий на саванну на закате...",
    promptHint: "Вы можете использовать обычный текст или строку в формате JSON.",
    referenceImageLabel: "Эталонное изображение (необязательно)",
    uploadFile: "Загрузить файл",
    dragAndDrop: "или перетащить",
    fileTypes: "PNG, JPG, GIF до 10 МБ",
    generationSettings: "Настройки генерации",
    aspectRatioLabel: "Соотношение сторон",
    soundLabel: "Звук",
    enableSound: "Включить звук",
    resolutionLabel: "Разрешение",
    apiKeyMissingWarning: "Пожалуйста, добавьте и выберите активный ключ API, чтобы начать.",
    generateButton: "Создать видео",
    generatingButton: "Создание видео...",
    loaderTitle: "Создание вашего видео",
    loadingMessages: [ "Инициализация модели VEO...", "Анализ вашего запроса...", "Компоновка основной сцены...", "Генерация начальных кадров...", "Рендеринг видеопоследовательности... это может занять несколько минут.", "Масштабирование до высокого разрешения...", "Добавление звука и финальные штрихи...", "Почти готово, подготовка финального видеофайла." ],
    playerTitle: "Создание завершено!",
    downloadButton: "Скачать видео",
    apiKeyManagerTitle: "Менеджер ключей API",
    addNewKeyLabel: "Добавить новый ключ API",
    apiKeyInputPlaceholder: "Введите ваш ключ API Gemini",
    addKeyButton: "Добавить ключ",
    validatingButton: "Проверка...",
    savedKeysLabel: "Сохраненные ключи",
    noKeysSaved: "Нет сохраненных ключей API.",
    addKeyPrompt: "Добавьте ключ выше, чтобы начать.",
    closeButton: "Закрыть",
    errorKeyEmpty: "Ключ API не может быть пустым.",
    errorKeyExists: "Этот ключ API уже добавлен.",
    errorKeyInvalid: "Неверный ключ API или проблема с сетью. Пожалуйста, проверьте ключ и попробуйте снова.",
    generationFailed: "Ошибка создания",
    alertEnterPrompt: "Пожалуйста, введите запрос.",
    alertSetApiKey: "Пожалуйста, установите активный ключ API перед созданием видео.",
  },
  // Japanese
  ja: {
    appName: "AL ANSHOR VEO ビデオジェネレーター",
    appTagline: "テキストや画像から素晴らしいビデオを生成します。",
    manageApiKeys: "APIキーの管理",
    promptLabel: "プロンプト",
    promptPlaceholder: "夕日に照らされたサバンナを見下ろす雄大なライオン...",
    promptHint: "プレーンテキストまたはJSON形式の文字列を使用できます。",
    referenceImageLabel: "参照画像（オプション）",
    uploadFile: "ファイルをアップロード",
    dragAndDrop: "またはドラッグ＆ドロップ",
    fileTypes: "PNG, JPG, GIF 最大10MB",
    generationSettings: "生成設定",
    aspectRatioLabel: "アスペクト比",
    soundLabel: "サウンド",
    enableSound: "サウンドを有効にする",
    resolutionLabel: "解像度",
    apiKeyMissingWarning: "開始するには、アクティブなAPIキーを追加して選択してください。",
    generateButton: "ビデオを生成",
    generatingButton: "ビデオを生成中...",
    loaderTitle: "ビデオを生成中",
    loadingMessages: [ "VEOモデルを初期化中...", "プロンプトを分析中...", "メインシーンを作成中...", "初期フレームを生成中...", "ビデオシーケンスをレンダリング中...これには数分かかることがあります。", "高解像度にアップスケーリング中...", "サウンドと最終仕上げを追加中...", "もうすぐです、最終的なビデオファイルを準備しています。" ],
    playerTitle: "生成が完了しました！",
    downloadButton: "ビデオをダウンロード",
    apiKeyManagerTitle: "APIキーマネージャー",
    addNewKeyLabel: "新しいAPIキーを追加",
    apiKeyInputPlaceholder: "Gemini APIキーを入力してください",
    addKeyButton: "キーを追加",
    validatingButton: "検証中...",
    savedKeysLabel: "保存されたキー",
    noKeysSaved: "保存されているAPIキーはありません。",
    addKeyPrompt: "開始するには、上にキーを追加してください。",
    closeButton: "閉じる",
    errorKeyEmpty: "APIキーは空にできません。",
    errorKeyExists: "このAPIキーは既に追加されています。",
    errorKeyInvalid: "無効なAPIキーまたはネットワークの問題です。キーを確認して再試行してください。",
    generationFailed: "生成に失敗しました",
    alertEnterPrompt: "プロンプトを入力してください。",
    alertSetApiKey: "ビデオを生成する前に、アクティブなAPIキーを設定してください。",
  },
  // German
  de: {
    appName: "AL ANSHOR VEO GENERATOR",
    appTagline: "Erstellen Sie beeindruckende Videos aus Text oder Bildern.",
    manageApiKeys: "API-Schlüssel verwalten",
    promptLabel: "Prompt",
    promptPlaceholder: "Ein majestätischer Löwe, der bei Sonnenuntergang die Savanne überblickt...",
    promptHint: "Sie können einfachen Text oder eine JSON-formatierte Zeichenfolge verwenden.",
    referenceImageLabel: "Referenzbild (Optional)",
    uploadFile: "Datei hochladen",
    dragAndDrop: "oder ziehen und ablegen",
    fileTypes: "PNG, JPG, GIF bis zu 10MB",
    generationSettings: "Generierungseinstellungen",
    aspectRatioLabel: "Seitenverhältnis",
    soundLabel: "Ton",
    enableSound: "Ton aktivieren",
    resolutionLabel: "Auflösung",
    apiKeyMissingWarning: "Bitte fügen Sie einen aktiven API-Schlüssel hinzu und wählen Sie ihn aus, um zu beginnen.",
    generateButton: "Video generieren",
    generatingButton: "Video wird generiert...",
    loaderTitle: "Ihr Video wird generiert",
    loadingMessages: [ "VEO-Modell wird initialisiert...", "Ihr Prompt wird analysiert...", "Hauptszene wird komponiert...", "Anfangsbilder werden generiert...", "Videosequenz wird gerendert... dies kann einige Minuten dauern.", "Hochskalieren auf hohe Auflösung...", "Ton und letzte Feinheiten werden hinzugefügt...", "Fast fertig, die endgültige Videodatei wird vorbereitet." ],
    playerTitle: "Generierung abgeschlossen!",
    downloadButton: "Video herunterladen",
    apiKeyManagerTitle: "API-Schlüssel-Manager",
    addNewKeyLabel: "Neuen API-Schlüssel hinzufügen",
    apiKeyInputPlaceholder: "Geben Sie Ihren Gemini-API-Schlüssel ein",
    addKeyButton: "Schlüssel hinzufügen",
    validatingButton: "Wird validiert...",
    savedKeysLabel: "Gespeicherte Schlüssel",
    noKeysSaved: "Keine API-Schlüssel gespeichert.",
    addKeyPrompt: "Fügen Sie oben einen Schlüssel hinzu, um zu beginnen.",
    closeButton: "Schließen",
    errorKeyEmpty: "API-Schlüssel darf nicht leer sein.",
    errorKeyExists: "Dieser API-Schlüssel wurde bereits hinzugefügt.",
    errorKeyInvalid: "Ungültiger API-Schlüssel oder Netzwerkproblem. Bitte überprüfen Sie den Schlüssel und versuchen Sie es erneut.",
    generationFailed: "Generierung fehlgeschlagen",
    alertEnterPrompt: "Bitte geben Sie einen Prompt ein.",
    alertSetApiKey: "Bitte legen Sie vor dem Generieren eines Videos einen aktiven API-Schlüssel fest.",
  },
  // French
  fr: {
    appName: "GÉNÉRATEUR VIDÉO AL ANSHOR VEO",
    appTagline: "Générez des vidéos époustouflantes à partir de texte ou d'images.",
    manageApiKeys: "Gérer les clés API",
    promptLabel: "Instruction",
    promptPlaceholder: "Un lion majestueux surplombant la savane au coucher du soleil...",
    promptHint: "Vous pouvez utiliser du texte brut ou une chaîne au format JSON.",
    referenceImageLabel: "Image de référence (Optionnel)",
    uploadFile: "Télécharger un fichier",
    dragAndDrop: "ou glisser-déposer",
    fileTypes: "PNG, JPG, GIF jusqu'à 10 Mo",
    generationSettings: "Paramètres de génération",
    aspectRatioLabel: "Ratio d'aspect",
    soundLabel: "Son",
    enableSound: "Activer le son",
    resolutionLabel: "Résolution",
    apiKeyMissingWarning: "Veuillez ajouter et sélectionner une clé API active pour commencer.",
    generateButton: "Générer la vidéo",
    generatingButton: "Génération de la vidéo...",
    loaderTitle: "Génération de votre vidéo",
    loadingMessages: [ "Initialisation du modèle VEO...", "Analyse de votre instruction...", "Composition de la scène principale...", "Génération des premières images...", "Rendu de la séquence vidéo... cela peut prendre quelques minutes.", "Mise à l'échelle en haute résolution...", "Ajout du son et des touches finales...", "Presque terminé, préparation du fichier vidéo final." ],
    playerTitle: "Génération terminée !",
    downloadButton: "Télécharger la vidéo",
    apiKeyManagerTitle: "Gestionnaire de clés API",
    addNewKeyLabel: "Ajouter une nouvelle clé API",
    apiKeyInputPlaceholder: "Entrez votre clé API Gemini",
    addKeyButton: "Ajouter la clé",
    validatingButton: "Validation...",
    savedKeysLabel: "Clés enregistrées",
    noKeysSaved: "Aucune clé API enregistrée.",
    addKeyPrompt: "Ajoutez une clé ci-dessus pour commencer.",
    closeButton: "Fermer",
    errorKeyEmpty: "La clé API ne peut pas être vide.",
    errorKeyExists: "Cette clé API a déjà été ajoutée.",
    errorKeyInvalid: "Clé API invalide ou problème de réseau. Veuillez vérifier la clé et réessayer.",
    generationFailed: "Échec de la génération",
    alertEnterPrompt: "Veuillez entrer une instruction.",
    alertSetApiKey: "Veuillez définir une clé API active avant de générer une vidéo.",
  },
};

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string | string[];
  dir: 'ltr' | 'rtl';
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

const getInitialLanguage = (): Language => {
    try {
        const storedLang = localStorage.getItem(LANGUAGE_STORAGE_KEY);
        if (storedLang && Object.keys(languageMap).includes(storedLang)) {
            return storedLang as Language;
        }
        const browserLang = navigator.language.split('-')[0];
        if (browserLang && Object.keys(languageMap).includes(browserLang)) {
           return browserLang as Language;
        }
    } catch (e) {
        console.error("Could not access localStorage, defaulting to English.", e);
    }
    return 'en';
};

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguageState] = useState<Language>(getInitialLanguage);

  useEffect(() => {
    try {
        localStorage.setItem(LANGUAGE_STORAGE_KEY, language);
    } catch (e) {
        console.error("Could not save language to localStorage.", e);
    }
  }, [language]);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
  };
  
  const t = useCallback((key: string): string | string[] => {
    const keys = key.split('.');
    let result: any = translations[language];
    for (const k of keys) {
        result = result?.[k];
        if (result === undefined) {
            console.warn(`Translation key not found: ${key} for language: ${language}`);
            // Fallback to English
            let fallbackResult: any = translations['en'];
            for (const fk of keys) {
                fallbackResult = fallbackResult?.[fk];
                 if (fallbackResult === undefined) return key;
            }
            return fallbackResult;
        }
    }
    return result;
  }, [language]);

  const dir = language === 'ar' ? 'rtl' : 'ltr';

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t, dir }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLocalization = (): LanguageContextType => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLocalization must be used within a LanguageProvider');
  }
  return context;
};